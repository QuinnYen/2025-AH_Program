# 2025-AH 學習歷程資料分析系統

這是一個專為教育機構設計的學習歷程資料處理與分析系統，提供完整的資料處理、統計分析和可視化功能。

## 🎯 系統概述

本系統主要針對大學課程成績資料進行分析，包含：
- **資料分割與處理**：依學年度自動分割大型資料集
- **成績統計分析**：計算各類課程的平均成績
- **統計假設檢驗**：執行 T-test 分析比較不同群體表現
- **相關性分析**：探索不同課程類型間的關聯性
- **視覺化報表**：產生專業的圖表和 Excel 分析報告

## 📊 系統架構

```
2025-AH_Program/
├── 01_split-Excel.py         # 資料分割處理程式
├── 02_Filter.py              # 資料篩選與統計程式  
├── 03_T-test.py              # T-test 統計分析程式
├── 04_CorrelationAnalysis.py # 相關性分析程式
├── README.md                 # 專案說明文件
└── 全校課程與學籍1101-1131/   # 資料目錄
    ├── 110-1131學期大學部課程資料.xlsx
    ├── SIRE31.CSV
    └── 處理結果_[時間戳]/     # 自動產生的分析結果
        ├── 110學年度/
        ├── 111學年度/
        ├── 112學年度/
        └── 113學年度/
```

## 🚀 功能模組詳解

### 1. 資料分割模組 (`01_split-Excel.py`)

**核心功能：**
- 📁 依學年度自動分割大型資料檔案
- 🔗 學生基本資料合併（學院、科系資訊）
- 📈 圖形化進度監控與背景處理
- 🛡️ 完善的錯誤處理機制

**主要特色：**
- 支援 Excel (.xlsx, .xls) 和 CSV 檔案格式
- 多執行緒處理，避免介面凍結
- 自動欄位寬度調整
- 智能學號格式處理
- 重複資料檢測與處理

**使用流程：**
1. 選取主要課程資料檔案
2. （可選）選取學生基本資料檔案
3. 點擊「開始處理」
4. 系統自動產生分學年度的資料檔案

### 2. 資料篩選模組 (`02_Filter.py`)

**核心功能：**
- 📋 學生基本資料提取與去重
- 📊 自動計算四類課程平均成績：
  - 一般必修課程
  - 一般選修課程  
  - 通識必修課程
  - 通識選修課程
- 🔄 智能空值處理

**處理邏輯：**
- 通識選修：課程代碼以 "GE" 開頭
- 通識必修：課程代碼以 "GQ" 開頭或特定課程名稱
- 一般必修：必選修欄位包含"必修"或"教必"
- 一般選修：必選修欄位包含"選修"或"教選"

### 3. T-test 分析模組 (`03_T-test.py`)

**統計分析功能：**

**第一類：課程類型比較（配對 t-test）**
- 一般必修 vs 一般選修
- 通識必修 vs 通識選修
- 一般必修 vs 通識必修
- 一般選修 vs 通識選修
- 所有必修 vs 所有選修
- 所有一般課程 vs 所有通識課程

**第二類：群體間比較（獨立樣本 t-test）**
- 學院間成績比較（7大學院 × 4種課程類型 = 84項分析）
- 高 GPA vs 低 GPA 學生比較
- 科系頂尖 20% vs 後段 20% 比較

**第三類：特殊情境分析**
- 必修高分學生的選修表現
- 選修高分學生的必修表現

**技術特色：**
- 90+ 項自動化統計分析
- 即時進度追蹤與取消功能
- 詳細的 debug 日誌系統
- 完整的 Excel 分析報表
- 統計顯著性自動判定

### 4. 相關性分析模組 (`04_CorrelationAnalysis.py`)

**分析功能：**
- 📈 Pearson 相關係數計算
- 🔥 相關性熱力圖視覺化
- 📊 散佈圖矩陣產生
- 🏫 按學院分組分析
- 📋 完整的相關性報表

**視覺化輸出：**
- 相關性熱力圖 (PNG)
- 6組散佈圖矩陣 (PNG)
- 詳細分析結果 (Excel)

## 🛠️ 系統需求

### 運行環境
- **Python 版本**：3.7 或更新版本
- **作業系統**：Windows 10/11、macOS、Linux

### 必要套件
```bash
pandas >= 1.3.0          # 資料處理
numpy >= 1.20.0          # 數值計算
scipy >= 1.7.0           # 統計分析
openpyxl >= 3.0.0        # Excel 檔案支援
matplotlib >= 3.3.0      # 圖表繪製
seaborn >= 0.11.0        # 統計視覺化
tkinter                  # GUI 介面（Python 內建）
```

## 📦 安裝與設定

### 1. 環境建立
```bash
# 克隆專案
git clone https://github.com/your-username/2025-AH_Program.git
cd 2025-AH_Program

# 建立虛擬環境（建議）
python -m venv venv

# 啟動虛擬環境
# Windows
venv\Scripts\activate
# macOS/Linux  
source venv/bin/activate
```

### 2. 套件安裝
```bash
# 安裝必要套件
pip install pandas numpy scipy openpyxl matplotlib seaborn

# 或使用 requirements.txt（如果提供）
pip install -r requirements.txt
```

### 3. 驗證安裝
```bash
python -c "import pandas, numpy, scipy, openpyxl, matplotlib, seaborn; print('所有套件安裝成功！')"
```

## 📖 使用指南

### 標準工作流程

**步驟 1：資料分割**
```bash
python 01_split-Excel.py
```
- 選擇完整的課程資料檔案
- 可選擇學生基本資料檔案
- 系統自動依學年度分割資料

**步驟 2：資料篩選**
```bash
python 02_Filter.py
```
- 選擇已分割的學年度資料
- 自動計算各類課程平均成績
- 產生處理結果檔案

**步驟 3：統計分析**
```bash
python 03_T-test.py
```
- 載入處理後的 CSV 檔案
- 選擇分析類型或執行完整分析
- 產生統計分析報表

**步驟 4：相關性分析**
```bash
python 04_CorrelationAnalysis.py
```
- 選擇資料檔案
- 設定分析選項
- 產生相關性分析結果

### 資料格式要求

**主要資料檔案必要欄位：**
- `學號`：學生識別碼
- `開課學年期`：格式為 4 位數字（如：1101）
- `課程代碼`：課程識別碼
- `課程名稱`：課程完整名稱
- `成績`：數值成績
- `必選修`：課程類型標示

**基本資料檔案必要欄位：**
- `學號`：學生識別碼
- `學院`：學生所屬學院
- `學生系級`或`科系`：學生科系資訊

## 📊 輸出結果說明

### 檔案命名規則
```
處理結果_YYYYMMDD_HHMMSS/
├── [學年度]學年度/
│   ├── [學年度]學年度課程資料.xlsx           # 原始分割資料
│   ├── [學年度]學年度課程資料_處理結果.xlsx   # 統計處理結果  
│   ├── correlation_heatmap_[時間戳].png      # 相關性熱力圖
│   ├── scatter_plots_[時間戳].png            # 散佈圖矩陣
│   └── 相關性分析結果_[時間戳].xlsx           # 相關性分析報表
```

### Excel 報表內容

**T-test 分析報表：**
- 分析總覽：統計摘要資訊
- 配對 t-test 結果：課程類型比較
- 獨立樣本 t-test 結果：群體間比較
- 顯著結果摘要：重點發現
- 原始資料範例：資料品質檢查
- 資料摘要統計：描述性統計

**相關性分析報表：**
- 詳細相關性分析：完整數據表
- 相關性矩陣：係數矩陣
- 結果解釋：統計意義說明

## ⚡ 效能優化

### 大型資料處理
- 使用多執行緒背景處理
- 記憶體優化的資料讀取
- 分批處理大型資料集
- 智能進度追蹤

### 處理速度參考
| 資料量 | 分割處理 | 統計分析 | 相關性分析 |
|--------|----------|----------|------------|
| 1萬筆  | ~30秒    | ~1分鐘   | ~30秒      |
| 5萬筆  | ~2分鐘   | ~3分鐘   | ~1分鐘     |
| 10萬筆 | ~5分鐘   | ~6分鐘   | ~2分鐘     |

## 🔧 進階功能

### 自定義分析
- 可修改統計顯著性水準
- 彈性的學院和科系分組
- 自定義相關性分析組合
- 可調整視覺化參數

### 批次處理
```bash
# 批次處理多個學年度
for year in 110 111 112 113; do
    python 02_Filter.py --input "data/${year}學年度課程資料.xlsx"
done
```

### Debug 模式
```bash
# 開啟詳細 debug 資訊
DEBUG_LEVEL=2 python 01_split-Excel.py
```

## 🐛 疑難排解

### 常見問題與解決方案

**Q: 編碼錯誤**
```
UnicodeDecodeError: 'utf-8' codec can't decode...
```
A: 系統自動嘗試多種編碼格式，若仍有問題請轉換檔案為 UTF-8 編碼

**Q: 記憶體不足**
```
MemoryError: Unable to allocate array
```
A: 建議將大型檔案分批處理，或增加系統虛擬記憶體

**Q: Excel 檔案無法開啟**
```
BadZipFile: File is not a zip file
```
A: 檢查檔案格式，確保為有效的 Excel 檔案

**Q: 統計分析無結果**
```
ValueError: x and y must have the same length
```
A: 檢查資料品質，確保有足夠的有效成績資料

### 日誌檔案
系統自動產生詳細的日誌檔案：
- `ttest_debug_YYYYMMDD.log`：T-test 分析日誌
- 終端機即時輸出：處理進度和錯誤訊息

## 📈 使用案例

### 教育研究應用
- **學習成效評估**：比較不同課程類型的學習效果
- **教學改進建議**：識別需要改進的課程領域
- **學生能力分析**：了解學生在不同領域的表現差異
- **課程關聯研究**：探索課程間的相互影響

### 行政管理應用
- **課程規劃**：基於統計結果優化課程設計
- **學院評比**：客觀比較不同學院的教學成效
- **招生分析**：為招生策略提供數據支持
- **品質監控**：持續監控教學品質變化

## 🔄 更新日誌

### v2.0.0
- ✅ 新增相關性分析模組
- ✅ 完整的視覺化功能
- ✅ 優化的使用者介面
- ✅ 增強的錯誤處理

### v1.5.0
- ✅ T-test 統計分析功能
- ✅ 90+ 項自動化分析
- ✅ 即時進度追蹤
- ✅ Excel 自動報表生成

### v1.0.0
- ✅ 基礎資料分割功能
- ✅ 成績統計處理
- ✅ GUI 操作介面
- ✅ 多格式檔案支援

## 🤝 開發貢獻

歡迎提交 Issue 和 Pull Request 來改進系統功能。

### 開發規範
- 遵循 PEP 8 程式碼風格
- 提供完整的功能測試
- 撰寫清晰的 commit 訊息
- 更新相關文件

## 📄 授權資訊

本專案採用 MIT 授權條款，詳見 LICENSE 檔案。

## 📞 技術支援

如遇到問題，請檢查：
1. **Python 版本**：確保使用 Python 3.7+
2. **套件版本**：確保所有套件版本符合需求
3. **資料格式**：確保輸入檔案格式正確
4. **系統權限**：確保有檔案讀寫權限
5. **記憶體空間**：確保有足夠的系統記憶體

---

> 💡 **使用建議**：首次使用請先用小量測試資料驗證系統功能，確認無誤後再處理完整資料集。

> 📊 **資料安全**：系統僅進行本地資料處理，不會上傳任何資料到外部伺服器，確保資料安全。

> 🎯 **最佳實踐**：建議定期備份原始資料，並保存分析結果以供後續比較研究。