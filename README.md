# 2025-AH 學習歷程資料分析系統

這是一個專為教育機構設計的學習歷程資料處理與分析系統，提供完整的資料處理、統計分析和可視化功能。

## 🎯 系統概述

本系統主要針對大學課程成績資料進行分析，包含：
- **資料分割與處理**：依學年度自動分割大型資料集
- **成績統計分析**：計算各類課程的平均成績
- **統計假設檢驗**：執行 T-test 分析比較不同群體表現
- **相關性分析**：探索不同課程類型間的關聯性
- **視覺化報表**：產生專業的圖表和 Excel 分析報告

## 📊 系統架構

**主要程式檔案：**
- `01_split-Excel.py`：資料分割處理程式
- `02_Filter.py`：資料篩選與統計程式  
- `03_T-test.py`：T-test 統計分析程式
- `04_CorrelationAnalysis.py`：相關性分析程式
- `README.md`：專案說明文件

**資料目錄結構：**
- `全校課程與學籍1101-1131/`：主要資料目錄
  - 原始課程資料檔案（Excel/CSV 格式）
  - `處理結果_[時間戳]/`：自動產生的分析結果
    - 各學年度分析結果資料夾

## 🚀 功能模組詳解

### 1. 資料分割模組 (`01_split-Excel.py`)

**核心功能：**
- 📁 依學年度自動分割大型資料檔案
- 🔗 學生基本資料合併（學院、科系資訊）
- 📈 圖形化進度監控與背景處理
- 🛡️ 完善的錯誤處理機制

**主要特色：**
- 支援 Excel (.xlsx, .xls) 和 CSV 檔案格式
- 多執行緒處理，避免介面凍結
- 自動欄位寬度調整
- 智能學號格式處理
- 重複資料檢測與處理

**使用流程：**
1. 選取主要課程資料檔案
2. （可選）選取學生基本資料檔案
3. 點擊「開始處理」
4. 系統自動產生分學年度的資料檔案

### 2. 資料篩選模組 (`02_Filter.py`)

**核心功能：**
- 📋 學生基本資料提取與去重
- 📊 自動計算四類課程平均成績：
  - 一般必修課程
  - 一般選修課程  
  - 通識必修課程
  - 通識選修課程
- 🔄 智能空值處理

**處理邏輯：**
- 通識選修：課程代碼以 "GE" 開頭
- 通識必修：課程代碼以 "GQ" 開頭或特定課程名稱
- 一般必修：必選修欄位包含"必修"或"教必"
- 一般選修：必選修欄位包含"選修"或"教選"

### 3. T-test 分析模組 (`03_T-test.py`)

本模組執行全面性的統計假設檢驗，採用七大類系統性分析架構，提供教育研究所需的多角度統計證據。

#### 🧪 統計分析框架

**========== 第一類：基礎課程類型比較 ==========**
*研究目的：細分比較各種課程類型之間的表現差異*
- **一般必修 vs 一般選修**：檢驗專業必修課程與專業選修課程的成績差異
- **通識必修 vs 通識選修**：比較通識教育中必修與選修課程的學習成效
- **一般必修 vs 通識必修**：探討專業必修與通識必修的難度差異
- **一般選修 vs 通識選修**：分析專業選修與通識選修的表現差異

**========== 第二類：制度性分析 ==========**
*研究目的：從必修/選修制度角度分析整體學習成效差異*
- **所有必修 vs 所有選修**：整體比較必修課程制度與選修課程制度的教育成效
- 統計方法：配對 t-test（同一學生的必修與選修平均成績）

**========== 第三類：學科性質分析 ==========**
*研究目的：比較專業教育與通識教育的整體學習成效*
- **專業課程整體 vs 通識課程整體**：比較專業領域培養與通識素養培養的成效
- 分析維度：專業課程（一般必修+一般選修）vs 通識課程（通識必修+通識選修）

**========== 第四類：個人學習穩定度分析 ==========**
*研究目的：分析個人在不同課程類型間的學習表現穩定性*
- **個人最高分類別 vs 最低分類別**：檢驗學生個體內的學習表現一致性
- 研究意義：了解學生是否在特定課程類型有明顯優勢或劣勢

**========== 第五類：跨學科領域比較 ==========**
*研究目的：比較理工學科與人文社科學生的整體學習表現*
- **理工組 vs 人文社科組**：整合所有課程類型，比較不同學科背景學生的學習成效
- 理工組：理學院、工學院、電機資訊學院
- 人文社科組：商學院、設計學院、人文與教育學院、法學院

**========== 第六類：學習能力分層分析 ==========**
*研究目的：比較頂尖學生與後段學生在必修-選修課程差異表現*
- **頂尖 20% vs 後段 20%**：分析不同能力層級學生的課程適應性差異
- 創新指標：『必修-選修』差值，反映學生對不同課程制度的適應能力

**========== 第七類：學院間比較分析 ==========**
*研究目的：比較不同學院學生在各課程類型的學習表現差異*
- **7大學院 × 4種課程類型**：共 84 項比較分析
- 涵蓋學院：理學院、工學院、商學院、設計學院、人文與教育學院、法學院、電機資訊學院
- 課程類型：一般必修、一般選修、通識必修、通識選修

#### 🔬 統計方法說明

**配對 t-test（Paired t-test）**
- 適用於：同一學生在不同課程類型的成績比較
- 優勢：控制個體差異，提高統計檢驗力
- 應用情境：第一、二、三、四類分析

**獨立樣本 t-test（Independent t-test）**
- 適用於：不同群體學生間的成績比較
- 優勢：比較群體間真實差異
- 應用情境：第五、六、七類分析

#### 🎯 技術特色
- **93 項系統性統計分析**：涵蓋七大類研究面向
- **即時進度追蹤**：可視化進度條與取消功能
- **智能統計判定**：自動判定統計顯著性（p < 0.001, p < 0.01, p < 0.05）
- **完整分析報表**：Excel 格式詳細結果輸出
- **詳細日誌系統**：完整的 debug 和處理記錄

### 4. 相關性分析模組 (`04_CorrelationAnalysis.py`)

本模組提供專業級的課程相關性分析，採用多層次分析架構，從基礎統計到進階教育研究，全面探索課程類型間的關聯性模式。

#### 🔗 基礎相關性分析架構

**========== 核心統計分析 ==========**
- **Pearson 相關係數計算**：量化各課程類型間的線性關係強度
- **相關性矩陣**：4×4 課程類型完整相關性表格
- **統計顯著性檢驗**：自動判定相關性的統計意義（p < 0.001, 0.01, 0.05）
- **相關強度分類**：強相關、中等相關、弱相關的自動判定

**========== 視覺化輸出 ==========**
- **相關性熱力圖**：直觀呈現課程間關聯強度，支援色彩編碼
- **散佈圖矩陣**：展示課程成績的分布關係，包含趨勢線
- **專業圖表輸出**：高解析度 PNG 格式，適合學術報告

#### 🎓 進階教育研究分析

**========== 1. GPA分層學習連結分析 ==========**
*研究問題：不同表現水平學生的學習連結模式*
- **三層分組策略**：高分組(前30%)、中分組(中40%)、低分組(後30%)
- **學習連貫性評估**：分析「一好俱好」vs「各科獨立」現象
- **差異化教學依據**：為不同程度學生提供個性化學習建議
- **統計輸出**：各分組的相關性矩陣、平均相關性、學習連貫性評級

**========== 2. 必修課預測能力分析（偏相關） ==========**
*研究問題：控制學術能力後，專業領域內課程的純粹關聯*
- **統計方法**：偏相關分析，控制通識課程成績影響
- **預測能力評估**：「一般必修」對「一般選修」的淨預測效果
- **學術嚴謹性**：包含t統計量、p值、自由度計算
- **教育洞察**：區分整體學術能力 vs 專業領域特有關聯

**========== 3. 學習軌跡縱向分析 ==========**
*研究問題：學生學業表現的跨學年穩定性*
- **自動檔案偵測**：智能搜尋同目錄下多學年資料檔案
- **學生配對追蹤**：基於學號的縱向資料匹配
- **穩定性指標**：必修平均、選修平均、總平均的年際相關性
- **預測性評估**：學習表現的可預測性與波動因素分析

**========== 4. 詳細學院相關性分析 ==========**
*研究問題：不同學院的課程結構關聯特徵*
- **全學院覆蓋**：對每個學院進行完整的6組課程對分析
- **課程結構分類**：
  - 高度整合型：各類課程高度關聯，知識結構統一
  - 中等整合型：課程間存在中等關聯，部分知識互通
  - 低度整合型：各課程相對獨立，專業分工明確
  - 分化專精型：各課程高度分化，評估不同能力向度
- **學院間比較**：識別課程整合度最高/最低的學院
- **教育改進建議**：基於數據的課程設計優化方向

#### 🏛️ 學院課程結構深度分析

**重點比較維度：**
- **專業課程內部關聯**：一般必修 ↔ 一般選修
- **通識課程內部關聯**：通識必修 ↔ 通識選修  
- **跨領域平均關聯**：專業課程 ↔ 通識課程
- **課程設計理念差異**：統合連貫型 vs 多元分化型

**特色學院分析：**
- **設計學院**：理論課程與實作課程的關聯性模式
- **商學院**：課程體系的統合連貫性評估
- **理工學院**：基礎科學與應用技術的關聯強度
- **人文學院**：核心素養與專業知識的整合程度

#### 📊 Excel 分析報表系統

**多工作表結構：**
1. **詳細相關性分析**：基礎相關性統計結果
2. **相關性矩陣**：4×4 完整相關性係數表
3. **學院分析摘要**：各學院課程結構類型與統計指標
4. **各學院詳細相關性**：每個學院每個課程對的完整數據
5. **GPA分層相關性**：三個分層組別的詳細相關性數據
6. **GPA分層統計摘要**：學習連貫性評估結果
7. **偏相關分析**：控制變數後的純粹專業關聯
8. **學習軌跡縱向分析**：跨學年學習穩定性數據
9. **結果解釋**：統計意義與教育含義說明

#### 🔬 統計方法與技術特色

**統計嚴謹性：**
- **Pearson相關係數**：線性關係量化
- **偏相關分析**：控制第三變數影響
- **統計顯著性檢驗**：p值與t統計量計算
- **效果量評估**：相關強度的實際意義判定

**資料處理優化：**
- **智能缺失值處理**：保證分析結果的可靠性
- **樣本數門檻控制**：確保統計檢驗的有效性
- **異常值檢測**：提高相關性分析的準確性
- **多執行緒處理**：提升大數據分析效率

#### 🎯 教育研究應用價值

**學術研究支持：**
- **理論建構**：課程關聯性的實證模型
- **實證依據**：教學效果評估的量化指標
- **比較研究**：不同教育模式的關聯性差異
- **縱向研究**：學習軌跡的長期追蹤分析

**教育管理決策：**
- **課程優化**：基於關聯性的課程結構調整
- **教學改進**：針對性的教學策略制定
- **學院評鑑**：客觀的教學成效比較指標
- **招生規劃**：學科能力要求的科學設定

**學生發展支持：**
- **學習指導**：個性化的課程選擇建議
- **能力評估**：多維度學習表現分析
- **發展預測**：基於歷史數據的表現預估
- **適性教學**：分層分組的教學策略支持

## 🛠️ 系統需求

### 運行環境
- **Python 版本**：3.7 或更新版本
- **作業系統**：Windows 10/11、macOS、Linux

### 必要套件
- **pandas >= 1.3.0**：資料處理
- **numpy >= 1.20.0**：數值計算  
- **scipy >= 1.7.0**：統計分析
- **openpyxl >= 3.0.0**：Excel 檔案支援
- **matplotlib >= 3.3.0**：圖表繪製
- **seaborn >= 0.11.0**：統計視覺化
- **tkinter**：GUI 介面（Python 內建）

## 📦 安裝與設定

### 1. 環境建立
1. 克隆專案：`git clone https://github.com/QuinnYen/2025-AH_Program.git`
2. 進入專案目錄：`cd 2025-AH_Program`
3. 建立虛擬環境（建議）：`python -m venv venv`
4. 啟動虛擬環境：
   - Windows：`venv\Scripts\activate`
   - macOS/Linux：`source venv/bin/activate`

### 2. 套件安裝
安裝必要套件：`pandas numpy scipy openpyxl matplotlib seaborn`

### 3. 驗證安裝
執行 Python 指令確認所有套件安裝成功

## 📖 使用指南

### 標準工作流程

**步驟 1：資料分割**
執行 `01_split-Excel.py`
- 選擇完整的課程資料檔案
- 可選擇學生基本資料檔案
- 系統自動依學年度分割資料

**步驟 2：資料篩選**
執行 `02_Filter.py`
- 選擇已分割的學年度資料
- 自動計算各類課程平均成績
- 產生處理結果檔案

**步驟 3：統計分析**
執行 `03_T-test.py`
- 載入處理後的 CSV 檔案
- 選擇分析類型或執行完整分析
- 產生統計分析報表

**步驟 4：相關性分析**
執行 `04_CorrelationAnalysis.py`
- 選擇處理後的資料檔案
- **基礎分析選項**：
  - 產生相關性熱力圖
  - 產生散佈圖矩陣
  - 按學院分析
- **進階分析選項**：
  - GPA分層學習連結分析
  - 必修課預測能力分析（偏相關）
  - 學習軌跡縱向分析（需多學年檔案）
- 系統自動產生多工作表 Excel 分析報表

### 資料格式要求

**主要資料檔案必要欄位：**
- `學號`：學生識別碼
- `開課學年期`：格式為 4 位數字（如：1101）
- `課程代碼`：課程識別碼
- `課程名稱`：課程完整名稱
- `成績`：數值成績
- `必選修`：課程類型標示

**基本資料檔案必要欄位：**
- `學號`：學生識別碼
- `學院`：學生所屬學院
- `學生系級`或`科系`：學生科系資訊

## 📊 輸出結果說明

### 檔案命名規則
**處理結果目錄：** `處理結果_YYYYMMDD_HHMMSS/`
- **學年度資料夾：** `[學年度]學年度/`
  - `[學年度]學年度課程資料.xlsx`：原始分割資料
  - `[學年度]學年度課程資料_處理結果.xlsx`：統計處理結果  
  - `correlation_heatmap_[時間戳].png`：相關性熱力圖
  - `scatter_plots_[時間戳].png`：散佈圖矩陣
  - `相關性分析結果_[時間戳].xlsx`：相關性分析報表

### Excel 報表內容

**T-test 分析報表：**
- 分析總覽：統計摘要資訊
- 配對 t-test 結果：課程類型比較
- 獨立樣本 t-test 結果：群體間比較
- 顯著結果摘要：重點發現
- 原始資料範例：資料品質檢查
- 資料摘要統計：描述性統計

**相關性分析報表：**
- 詳細相關性分析：完整數據表
- 相關性矩陣：係數矩陣
- 結果解釋：統計意義說明

## ⚡ 效能優化

### 大型資料處理
- 使用多執行緒背景處理
- 記憶體優化的資料讀取
- 分批處理大型資料集
- 智能進度追蹤

### 處理速度參考
| 資料量 | 分割處理 | 統計分析 | 相關性分析 |
|--------|----------|----------|------------|
| 1萬筆  | ~30秒    | ~1分鐘   | ~30秒      |
| 5萬筆  | ~2分鐘   | ~3分鐘   | ~1分鐘     |
| 10萬筆 | ~5分鐘   | ~6分鐘   | ~2分鐘     |

## 🔧 進階功能

### 自定義分析
- 可修改統計顯著性水準
- 彈性的學院和科系分組
- 自定義相關性分析組合
- 可調整視覺化參數

### 批次處理
支援批次處理多個學年度資料

### Debug 模式
支援詳細 debug 資訊輸出

## 🐛 疑難排解

### 常見問題與解決方案

**Q: 編碼錯誤**
`UnicodeDecodeError: 'utf-8' codec can't decode...`
A: 系統自動嘗試多種編碼格式，若仍有問題請轉換檔案為 UTF-8 編碼

**Q: 記憶體不足**
`MemoryError: Unable to allocate array`
A: 建議將大型檔案分批處理，或增加系統虛擬記憶體

**Q: Excel 檔案無法開啟**
`BadZipFile: File is not a zip file`
A: 檢查檔案格式，確保為有效的 Excel 檔案

**Q: 統計分析無結果**
`ValueError: x and y must have the same length`
A: 檢查資料品質，確保有足夠的有效成績資料

### 日誌檔案
系統自動產生詳細的日誌檔案：
- `ttest_debug_YYYYMMDD.log`：T-test 分析日誌
- 終端機即時輸出：處理進度和錯誤訊息

## 🔄 更新日誌

### v2.0.0
- ✅ 新增相關性分析模組
- ✅ 完整的視覺化功能
- ✅ 優化的使用者介面
- ✅ 增強的錯誤處理

### v1.5.0
- ✅ T-test 統計分析功能
- ✅ 90+ 項自動化分析
- ✅ 即時進度追蹤
- ✅ Excel 自動報表生成

### v1.0.0
- ✅ 基礎資料分割功能
- ✅ 成績統計處理
- ✅ GUI 操作介面
- ✅ 多格式檔案支援

---

> 💡 **使用建議**：首次使用請先用小量測試資料驗證系統功能，確認無誤後再處理完整資料集。

> 📊 **資料安全**：系統僅進行本地資料處理，不會上傳任何資料到外部伺服器，確保資料安全。

> 🎯 **最佳實踐**：建議定期備份原始資料，並保存分析結果以供後續比較研究。
