# AH_MainProgram - 學習歷程資料處理系統

這是一個專為處理學生學習歷程資料設計的 Python 應用程式，提供 Excel/CSV 檔案的分割、篩選和資料處理功能。

## 🎯 主要功能

### 📊 檔案分割處理 (`01_split-Excel.py`)
- **學年度分割**：依據開課學年期自動分割資料檔案
- **基本資料合併**：可合併學生基本資料（學院、科系等）
- **多格式支援**：支援 Excel (.xlsx, .xls) 和 CSV 檔案
- **進度監控**：具有圖形化進度條，實時顯示處理狀態
- **背景處理**：使用多執行緒技術，避免介面凍結
- **錯誤處理**：完善的錯誤檢查和使用者友善的錯誤訊息

### 🔍 資料篩選處理 (`02_Filter.py`)
- **成績統計**：自動計算通識課程平均成績
- **課程分類**：區分一般必修、一般選修、通識必修、通識選修
- **資料去重**：自動移除重複的學生記錄
- **空欄處理**：智能處理缺失的資料欄位

### 📈 T-test統計分析 (`03_T-test.py`)
- **多種統計分析**：配對t-test、獨立樣本t-test、群體間比較
- **學院比較**：支援7大學院間的各種統計比較
- **課程類型分析**：必修vs選修、一般vs通識課程比較
- **自動化分析**：一鍵執行90+項統計分析
- **進度追蹤**：即時顯示分析進度，支援取消操作
- **Excel報表**：自動產生完整的統計分析報表
- **除錯日誌**：詳細的終端機除錯報告和日誌檔案

## 🛠️ 系統需求

### Python 版本
- Python 3.7 或更新版本

### 必要套件
```
pandas >= 1.3.0
openpyxl >= 3.0.0
tkinter (Python 內建)
numpy >= 1.20.0
scipy >= 1.7.0
```

## 📦 安裝方式

1. **下載專案**
   ```bash
   git clone https://github.com/QuinnYen/2025-AH_Program.git
   cd AH_MainProgram
   ```

2. **建立虛擬環境** (建議)
   ```bash
   python -m venv .venv
   .venv\Scripts\activate  # Windows
   # 或
   source .venv/bin/activate  # macOS/Linux
   ```

3. **安裝相依套件**
   ```bash
   pip install pandas openpyxl numpy scipy
   ```

## 🚀 使用說明

### 檔案分割程式使用方法

1. **執行程式**
   ```bash
   python 01_split-Excel.py
   ```

2. **操作步驟**
   - 點擊「選取主要檔案」選擇要處理的 Excel/CSV 檔案
   - （可選）點擊「選取基本資料檔案」選擇包含學生資料的檔案
   - 點擊「開始處理」執行分割作業
   - 觀察進度條了解處理進度
   - 處理完成後，檔案會儲存在原檔案所在目錄

3. **輸出格式**
   - 檔案會依學年度分割（例如：`原檔名_110學年.xlsx`）
   - 如有基本資料，會自動合併學院、科系資訊

### 資料篩選程式使用方法

1. **執行程式**
   ```bash
   python 02_Filter.py
   ```

2. **操作步驟**
   - 選擇要處理的 Excel 檔案
   - 點擊「執行」開始處理
   - 程式會自動產生包含成績統計的結果檔案

### T-test統計分析程式使用方法

1. **執行程式**
   ```bash
   python 03_T-test.py
   ```

2. **操作步驟**
   - 點擊「選擇資料檔案」載入處理後的CSV檔案
   - 在資料預覽區確認資料正確載入
   - 選擇要執行的統計分析類型：
     * **配對t-test**：比較同一學生的不同課程類型成績
     * **獨立樣本t-test**：比較不同學院學生的成績表現
   - 點擊對應按鈕執行單一分析，或點擊「輸出完整分析報表」執行所有分析
   - 觀察進度視窗了解分析進度
   - 分析結果顯示在右側結果區域
   - Excel報表會自動儲存到指定位置

3. **分析類型說明**
   - **課程類型比較**：必修vs選修、一般vs通識
   - **學院間比較**：7大學院間的各種成績比較
   - **特殊分析**：高分學生表現分析
   - **完整報表**：包含所有90+項統計分析結果

## 📁 檔案結構

```
AH_MainProgram/
├── 01_split-Excel.py      # 主要分割處理程式
├── 02_Filter.py           # 資料篩選處理程式
├── 03_T-test.py          # T-test統計分析程式
├── .venv/                 # 虛擬環境目錄
├── .gitignore            # Git 忽略檔案設定
├── README.md             # 專案說明文件
├── ttest_debug_YYYYMMDD.log  # 日誌檔案（自動產生）
└── AH_MainProgram.code-workspace  # VS Code 工作區設定
```

## 💡 功能特色

### 🖥️ 使用者界面
- 直觀的圖形化操作介面
- 即時進度顯示
- 友善的錯誤提示訊息
- 可取消處理功能

### 🔧 技術特點
- **多執行緒處理**：避免長時間處理時界面凍結
- **記憶體優化**：適合處理大型資料檔案
- **編碼自動偵測**：支援 UTF-8 和 Big5 編碼
- **除錯模式**：提供詳細的處理資訊輸出
- **進度追蹤**：即時顯示處理進度，可取消長時間操作
- **統計分析**：完整的scipy統計功能整合

### 📊 資料處理
- 智能欄位識別
- 自動資料類型轉換
- 彈性的檔案格式支援
- 完整的錯誤恢復機制
- 配對與獨立樣本t-test分析
- 多學院群體比較分析
- 自動化Excel報表生成

## 🐛 疑難排解

### 常見問題

**Q: 程式執行時出現編碼錯誤**
A: 程式會自動嘗試 UTF-8 和 Big5 編碼，如仍有問題請檢查檔案編碼格式

**Q: 找不到必要欄位**
A: 請確認檔案包含以下必要欄位：
- 主檔案：`學號`、`開課學年期`
- 基本資料檔案：`學號`、`學院`

**Q: 處理大檔案時程式無回應**
A: 這是正常現象，請觀察進度條，程式在背景持續處理中

**Q: T-test分析時出現統計錯誤**
A: 請確認資料品質：
- 每組資料至少需要2個有效數值
- 檢查是否有過多的空值或異常值
- 確認成績數據為數值格式

**Q: Excel報表無法產生**
A: 請確認：
- 已安裝openpyxl套件
- 目標資料夾有寫入權限
- 檔案名稱不包含特殊字元

## 📝 注意事項

1. **檔案備份**：處理前請備份原始檔案
2. **欄位名稱**：確保檔案包含正確的欄位名稱
3. **資料格式**：學年期格式應為 4 位數字（例如：1101）
4. **檔案大小**：建議單一檔案不超過 100MB 以確保最佳效能
5. **T-test分析**：建議使用02_Filter.py處理後的CSV檔案作為輸入
6. **統計假設**：請確認資料符合t-test的基本假設（常態分佈、獨立性等）

## 🔄 更新日誌

### 最新版本特色
- ✅ 新增T-test統計分析功能
- ✅ 支援90+項自動化統計分析
- ✅ 實時進度追蹤系統
- ✅ 完整的除錯日誌功能
- ✅ Excel自動報表生成
- ✅ 新增背景處理功能
- ✅ 改善進度顯示
- ✅ 增強錯誤處理
- ✅ 支援取消處理功能
- ✅ 優化記憶體使用

## 📞 技術支援

如遇到問題或需要協助，請檢查：
1. Python 版本是否符合需求
2. 所有相依套件是否正確安裝
3. 輸入檔案格式是否正確
4. 檔案權限是否足夠

---

> 💡 **提示**：首次使用建議先用小量測試資料驗證功能正常後，再處理完整資料集。 
